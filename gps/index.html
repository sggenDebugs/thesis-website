<!DOCTYPE html>
<html>

<head>
    <title>Bike Tracking System</title>
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
    </style>
</head>

<body>
    <h1>Live Bike Tracking</h1>
    <div id="map"></div>

    <script>
        let map;
        let marker;

        function initMap() {
            // Initial map setup
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 9.30687095402185, lng: 123.30439309577068 },
                zoom: 15
            });

            // Define the bike icon once the API is available
            const bikeIcon = {
                url: '/img/bike-icon.png', // Custom bike icon
                scaledSize: new google.maps.Size(50, 50),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(25, 25)
            };

            marker = new google.maps.Marker({
                position: map.getCenter(),
                map: map,
                icon: bikeIcon,
                title: 'Bike Location'
            });

            // Update position every 2 seconds
            setInterval(updatePosition, 2000);
        }

        function updatePosition() {
            fetch('/gps/get_position.php?bike_id=1')
                .then(response => response.json())
                .then(data => {
                    const pos = { 
                        lat: parseFloat(data.latitude),
                        lng: parseFloat(data.longitude) };
                    marker.setPosition(pos);
                    map.panTo(pos);
                });
        }
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCewoqc0dlIGMOb0uHPZE2B_IP05bs2MCc&callback=initMap">
    </script>
</body>

</html>